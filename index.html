<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>Lúmina</title>

  <!-- Manifest -->
  <link rel="manifest" href="manifest.json">

  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: #000;
      overflow: hidden;
      touch-action: none;
    }

    canvas {
      display: block;
    }

    #loading {
      position: fixed;
      inset: 0;
      background: black;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: sans-serif;
      font-size: 24px;
      z-index: 10;
    }
  </style>
</head>

<body>
  <!-- Pantalla de carga -->
  <div id="loading">Cargando…</div>

  <!-- Juego -->
  <canvas id="game"></canvas>

  <script>
    // ===== MOTOR BÁSICO =====
    const canvas = document.getElementById("game");
    const ctx = canvas.getContext("2d");

    function resize() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    window.addEventListener("resize", resize);
    resize();

    // Quitar loading
    setTimeout(() => {
      document.getElementById("loading").style.display = "none";
    }, 1200);

    // ===== ESTADO DEL JUEGO =====
    let player = {
      x: 0,
      y: 0,
      speed: 4
    };

    let lightPower = 1;
    let time = 0;

    // Posición táctil
    let touchX = null;
    let touchY = null;

    window.addEventListener("touchstart", e => {
      const t = e.touches[0];
      touchX = t.clientX;
      touchY = t.clientY;
    });

    window.addEventListener("touchmove", e => {
      const t = e.touches[0];
      touchX = t.clientX;
      touchY = t.clientY;
    });

    window.addEventListener("touchend", () => {
      touchX = null;
      touchY = null;
    });

    // ===== BUCLE PRINCIPAL =====
    function loop() {
      time += 0.02;

      ctx.fillStyle = "#000";
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      // Movimiento del jugador
      if (touchX !== null && touchY !== null) {
        player.x += (touchX - player.x) * 0.05;
        player.y += (touchY - player.y) * 0.05;
      } else {
        player.x = canvas.width / 2 + Math.sin(time) * 120;
        player.y = canvas.height / 2 + Math.cos(time * 0.7) * 80;
      }

      // ===== LUZ INTERACTIVA =====
      const gradient = ctx.createRadialGradient(
        player.x,
        player.y,
        10,
        player.x,
        player.y,
        200 * lightPower
      );

      gradient.addColorStop(0, "rgba(255,255,200,0.9)");
      gradient.addColorStop(1, "rgba(0,0,0,0)");

      ctx.fillStyle = gradient;
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      // Núcleo de luz
      ctx.beginPath();
      ctx.arc(player.x, player.y, 6, 0, Math.PI * 2);
      ctx.fillStyle = "#fff";
      ctx.fill();

      requestAnimationFrame(loop);
    }

    // Inicio
    player.x = canvas.width / 2;
    player.y = canvas.height / 2;
    loop();
  </script>
</body>
</html>
<!-- build refresh -->
